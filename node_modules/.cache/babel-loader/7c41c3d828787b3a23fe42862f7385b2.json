{"ast":null,"code":"var _jsxFileName = \"/home/julia/Trybe/projects_Trybe/sd-06-project-recipes-app/src/pages/FoodDetailsProgress.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { requestDetailsFood } from '../services/requestsAPI';\nimport whiteHeartIcon from \"../images/whiteHeartIcon.svg\";\nimport blackHeartIcon from \"../images/blackHeartIcon.svg\";\nimport shareIcon from \"../images/shareIcon.svg\";\n\nfunction FoodDetailsProgress() {\n  const url = document.URL;\n  const actualId = url.split('/')[4];\n  const [foodDetails, setFoodDetails] = useState([]);\n  const [ingredients, setIngredients] = useState('');\n  const [favoriteFood, setFavoriteFood] = useState(false);\n  const [spanHidden, setSpanHidden] = useState(true);\n  const [checkedIngredients] = useState([]);\n  const [stateButton, setStateButton] = useState(true); // const { location } = props;\n  // const { state } = location;\n  // const { foodDetailsData: foodDetails, ingredientsData: ingredients } = state;\n  // console.log(foodDetails, ingredients, 'foodDetailssssss');\n\n  function verifyLocalStorage() {\n    if (localStorage.getItem('inProgressRecipes') === null) {\n      const recipesInProgress = {\n        cocktails: {},\n        meals: {}\n      };\n      localStorage.setItem('inProgressRecipes', JSON.stringify(recipesInProgress));\n    }\n  }\n\n  function enableButton() {\n    setStateButton(true);\n    const markedCheckboxes = document.querySelectorAll('input:checked');\n    const checkboxes = document.getElementsByClassName('check');\n    console.log('check1', markedCheckboxes.length);\n    console.log('check2', checkboxes.length);\n\n    if (checkboxes.length === markedCheckboxes.length) {\n      setStateButton(false);\n    }\n  }\n\n  function handleProgress(e) {\n    console.log(e.target.value);\n    checkedIngredients.push(e.target.value);\n    const localStorageRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    console.log(localStorageRecipes.meals);\n    localStorageRecipes.meals[foodDetails.idMeal] = checkedIngredients;\n    localStorage.setItem('inProgressRecipes', JSON.stringify(localStorageRecipes));\n    localStorage.setItem(e.target.value, e.target.checked);\n    enableButton();\n  }\n\n  useEffect(() => {\n    verifyLocalStorage();\n  }, []);\n  useEffect(() => {\n    async function fetchData() {\n      const resultsDetails = await requestDetailsFood(actualId);\n      const meal = resultsDetails.meals[0];\n      setFoodDetails(meal);\n      const keysMeal = Object.keys(meal);\n      const filterMeal = keysMeal.filter(key => key.toLowerCase().includes('ingredient'));\n      const filterMeasure = keysMeal.filter(key => key.toLowerCase().includes('measure'));\n      const allIngredients = filterMeal.map((item, index) => ({\n        ingredient: meal[item],\n        measure: meal[filterMeasure[index]]\n      })).filter(item => item.ingredient !== '' && item.ingredient !== null);\n      setIngredients(allIngredients);\n    }\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    const meuLocal = localStorage.getItem('favoriteRecipes');\n    console.log('local2', meuLocal);\n\n    if (meuLocal !== null) {\n      const meuLocalArray = JSON.parse(meuLocal);\n      console.log(meuLocalArray); // const idAtual = actualId[4];\n\n      const findId = meuLocalArray.find(element => element.id === actualId);\n      console.log(findId);\n\n      if (findId !== undefined) {\n        setFavoriteFood(true);\n      }\n    }\n  }, []);\n\n  function handleFavoriteFood() {\n    if (favoriteFood === false) {\n      console.log('entrou');\n      setFavoriteFood(true);\n      const favoriteObj = [{\n        id: foodDetails.idMeal,\n        type: 'comida',\n        area: foodDetails.strArea,\n        category: foodDetails.strCategory,\n        alcoholicOrNot: '',\n        name: foodDetails.strMeal,\n        image: foodDetails.strMealThumb\n      }];\n\n      if (localStorage.getItem('favoriteRecipes') === null) {\n        localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteObj));\n      } else {\n        localStorage.setItem('favoriteRecipes', JSON.stringify([...JSON.parse(localStorage.getItem('favoriteRecipes')), ...favoriteObj]));\n      }\n    }\n\n    if (favoriteFood === true) {\n      setFavoriteFood(false);\n      const arrayDoStorage = JSON.parse(localStorage.getItem('favoriteRecipes'));\n      console.log(arrayDoStorage);\n      const novoArray = arrayDoStorage.filter(element => element.id !== actualId);\n      console.log(novoArray);\n      localStorage.setItem('favoriteRecipes', JSON.stringify(novoArray));\n    }\n  }\n\n  function copyToClipBoard(text) {\n    const textSplice = text.split('/in-progress');\n    const finalText = textSplice.join('');\n    navigator.clipboard.writeText(finalText);\n    setSpanHidden(false);\n  }\n\n  function handleClickEnd() {\n    const time = new Date();\n    const object = [{\n      id: foodDetails.idMeal,\n      type: 'comida',\n      category: foodDetails.strCategory,\n      alcoholicOrNot: '',\n      area: foodDetails.strArea,\n      name: foodDetails.strMeal,\n      image: foodDetails.strMealThumb,\n      doneDate: time,\n      tags: foodDetails.strTags.split(',')\n    }];\n\n    if (localStorage.getItem('doneRecipes') === null) {\n      localStorage.setItem('doneRecipes', JSON.stringify(object));\n    } else {\n      localStorage.setItem('doneRecipes', JSON.stringify([...JSON.parse(localStorage.getItem('doneRecipes')), ...object]));\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    \"data-testid\": \"recipe-photo\",\n    width: \"100px\",\n    src: foodDetails.strMealThumb,\n    alt: \"Meal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    \"data-testid\": \"recipe-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }\n  }, foodDetails.strMeal), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"share-btn\",\n    onClick: () => copyToClipBoard(document.URL),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: shareIcon,\n    alt: \"Share\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    hidden: spanHidden,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, \"Link copiado!\"), /*#__PURE__*/React.createElement(\"button\", {\n    \"aria-label\": \"favorite-button\",\n    type: \"button\",\n    \"data-testid\": \"favorite-btn\",\n    onClick: handleFavoriteFood,\n    src: favoriteFood ? blackHeartIcon : whiteHeartIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: favoriteFood ? blackHeartIcon : whiteHeartIcon,\n    alt: \"favorite\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"h4\", {\n    \"data-testid\": \"recipe-category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }\n  }, foodDetails.meals && foodDetails.meals[0].strCategory), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"ingredients-div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }\n  }, ingredients && ingredients.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    \"data-testid\": `${index}-ingredient-step`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"check\",\n    type: \"checkbox\",\n    id: item.ingredient,\n    key: item.ingredient,\n    name: item.ingredient,\n    value: item.ingredient,\n    checked: JSON.parse(localStorage.getItem(item.ingredient)),\n    onChange: e => handleProgress(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: item.ingredient,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 15\n    }\n  }, `${index + 1} - ${item.ingredient}: ${item.measure}`)))), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }\n  }, foodDetails.strInstructions), /*#__PURE__*/React.createElement(\"video\", {\n    \"data-testid\": \"video\",\n    width: \"750\",\n    height: \"500\",\n    controls: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"source\", {\n    src: foodDetails.strYoutube,\n    type: \"video/mp4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"track\", {\n    src: \"\",\n    kind: \"captions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Link, {\n    to: \"/receitas-feitas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"finish-recipe-btn\",\n    disabled: stateButton,\n    onClick: handleClickEnd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, \"Finalizar receita\")));\n}\n\nexport default FoodDetailsProgress;","map":{"version":3,"sources":["/home/julia/Trybe/projects_Trybe/sd-06-project-recipes-app/src/pages/FoodDetailsProgress.js"],"names":["React","useState","useEffect","Link","requestDetailsFood","FoodDetailsProgress","url","document","URL","actualId","split","foodDetails","setFoodDetails","ingredients","setIngredients","favoriteFood","setFavoriteFood","spanHidden","setSpanHidden","checkedIngredients","stateButton","setStateButton","verifyLocalStorage","localStorage","getItem","recipesInProgress","cocktails","meals","setItem","JSON","stringify","enableButton","markedCheckboxes","querySelectorAll","checkboxes","getElementsByClassName","console","log","length","handleProgress","e","target","value","push","localStorageRecipes","parse","idMeal","checked","fetchData","resultsDetails","meal","keysMeal","Object","keys","filterMeal","filter","key","toLowerCase","includes","filterMeasure","allIngredients","map","item","index","ingredient","measure","meuLocal","meuLocalArray","findId","find","element","id","undefined","handleFavoriteFood","favoriteObj","type","area","strArea","category","strCategory","alcoholicOrNot","name","strMeal","image","strMealThumb","arrayDoStorage","novoArray","copyToClipBoard","text","textSplice","finalText","join","navigator","clipboard","writeText","handleClickEnd","time","Date","object","doneDate","tags","strTags","shareIcon","blackHeartIcon","whiteHeartIcon","strInstructions","strYoutube"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { requestDetailsFood } from '../services/requestsAPI';\nimport whiteHeartIcon from '../images/whiteHeartIcon.svg';\nimport blackHeartIcon from '../images/blackHeartIcon.svg';\nimport shareIcon from '../images/shareIcon.svg';\n\nfunction FoodDetailsProgress() {\n  const url = document.URL;\n  const actualId = url.split('/')[4];\n  const [foodDetails, setFoodDetails] = useState([]);\n  const [ingredients, setIngredients] = useState('');\n  const [favoriteFood, setFavoriteFood] = useState(false);\n  const [spanHidden, setSpanHidden] = useState(true);\n  const [checkedIngredients] = useState([]);\n  const [stateButton, setStateButton] = useState(true);\n\n  // const { location } = props;\n  // const { state } = location;\n  // const { foodDetailsData: foodDetails, ingredientsData: ingredients } = state;\n  // console.log(foodDetails, ingredients, 'foodDetailssssss');\n\n  function verifyLocalStorage() {\n    if (localStorage.getItem('inProgressRecipes') === null) {\n      const recipesInProgress = {\n        cocktails: {},\n        meals: {},\n      };\n      localStorage.setItem('inProgressRecipes', JSON.stringify(recipesInProgress));\n    }\n  }\n\n  function enableButton() {\n    setStateButton(true);\n    const markedCheckboxes = document.querySelectorAll('input:checked');\n    const checkboxes = document.getElementsByClassName('check');\n    console.log('check1', markedCheckboxes.length);\n    console.log('check2', checkboxes.length);\n    if (checkboxes.length === markedCheckboxes.length) {\n      setStateButton(false);\n    }\n  }\n\n  function handleProgress(e) {\n    console.log(e.target.value);\n    checkedIngredients.push((e.target.value));\n    const localStorageRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    console.log(localStorageRecipes.meals);\n    localStorageRecipes.meals[foodDetails.idMeal] = checkedIngredients;\n    localStorage.setItem('inProgressRecipes', JSON.stringify(localStorageRecipes));\n    localStorage.setItem(e.target.value, e.target.checked);\n    enableButton();\n  }\n\n  useEffect(() => {\n    verifyLocalStorage();\n  }, []);\n\n  useEffect(() => {\n    async function fetchData() {\n      const resultsDetails = await requestDetailsFood(actualId);\n      const meal = resultsDetails.meals[0];\n      setFoodDetails(meal);\n      const keysMeal = Object.keys(meal);\n      const filterMeal = keysMeal\n        .filter((key) => key.toLowerCase().includes('ingredient'));\n      const filterMeasure = keysMeal\n        .filter((key) => key.toLowerCase().includes('measure'));\n      const allIngredients = filterMeal\n        .map((item, index) => ({\n          ingredient: meal[item], measure: meal[filterMeasure[index]],\n        })).filter((item) => item.ingredient !== '' && item.ingredient !== null);\n      setIngredients(allIngredients);\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    const meuLocal = localStorage.getItem('favoriteRecipes');\n    console.log('local2', meuLocal);\n    if (meuLocal !== null) {\n      const meuLocalArray = JSON.parse(meuLocal);\n      console.log(meuLocalArray);\n      // const idAtual = actualId[4];\n      const findId = meuLocalArray.find((element) => element.id === actualId);\n      console.log(findId);\n      if (findId !== undefined) {\n        setFavoriteFood(true);\n      }\n    }\n  }, []);\n\n  function handleFavoriteFood() {\n    if (favoriteFood === false) {\n      console.log('entrou');\n      setFavoriteFood(true);\n      const favoriteObj = [\n        {\n          id: foodDetails.idMeal,\n          type: 'comida',\n          area: foodDetails.strArea,\n          category: foodDetails.strCategory,\n          alcoholicOrNot: '',\n          name: foodDetails.strMeal,\n          image: foodDetails.strMealThumb,\n        },\n      ];\n      if (localStorage.getItem('favoriteRecipes') === null) {\n        localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteObj));\n      } else {\n        localStorage.setItem(\n          'favoriteRecipes',\n          JSON.stringify([\n            ...JSON.parse(localStorage.getItem('favoriteRecipes')),\n            ...favoriteObj,\n          ]),\n        );\n      }\n    }\n    if (favoriteFood === true) {\n      setFavoriteFood(false);\n      const arrayDoStorage = JSON.parse(localStorage.getItem('favoriteRecipes'));\n      console.log(arrayDoStorage);\n\n      const novoArray = arrayDoStorage.filter((element) => element.id !== actualId);\n      console.log(novoArray);\n\n      localStorage.setItem('favoriteRecipes', JSON.stringify(novoArray));\n    }\n  }\n\n  function copyToClipBoard(text) {\n    const textSplice = text.split('/in-progress');\n    const finalText = textSplice.join('');\n    navigator.clipboard.writeText(finalText);\n    setSpanHidden(false);\n  }\n\n  function handleClickEnd() {\n    const time = new Date();\n    const object = [\n      {\n        id: foodDetails.idMeal,\n        type: 'comida',\n        category: foodDetails.strCategory,\n        alcoholicOrNot: '',\n        area: foodDetails.strArea,\n        name: foodDetails.strMeal,\n        image: foodDetails.strMealThumb,\n        doneDate: time,\n        tags: foodDetails.strTags.split(','),\n      },\n    ];\n\n    if (localStorage.getItem('doneRecipes') === null) {\n      localStorage.setItem('doneRecipes', JSON.stringify(object));\n    } else {\n      localStorage.setItem(\n        'doneRecipes',\n        JSON.stringify([\n          ...JSON.parse(localStorage.getItem('doneRecipes')),\n          ...object,\n        ]),\n      );\n    }\n  }\n\n  return (\n    <div>\n\n      <img\n        data-testid=\"recipe-photo\"\n        width=\"100px\"\n        src={ foodDetails.strMealThumb }\n        alt=\"Meal\"\n      />\n\n      <h3 data-testid=\"recipe-title\">\n        {foodDetails.strMeal}\n      </h3>\n\n      <button\n        type=\"button\"\n        data-testid=\"share-btn\"\n        onClick={ () => copyToClipBoard(document.URL) }\n      >\n        <img src={ shareIcon } alt=\"Share\" />\n      </button>\n\n      <span hidden={ spanHidden }>Link copiado!</span>\n\n      <button\n        aria-label=\"favorite-button\"\n        type=\"button\"\n        data-testid=\"favorite-btn\"\n        onClick={ handleFavoriteFood }\n        src={ favoriteFood ? blackHeartIcon : whiteHeartIcon }\n      >\n        <img src={ favoriteFood ? blackHeartIcon : whiteHeartIcon } alt=\"favorite\" />\n      </button>\n\n      <h4 data-testid=\"recipe-category\">\n        {foodDetails.meals && foodDetails.meals[0].strCategory}\n      </h4>\n\n      <div id=\"ingredients-div\">\n        {ingredients && ingredients\n          .map((item, index) => (\n            <div key={ index } data-testid={ `${index}-ingredient-step` }>\n              <input\n                className=\"check\"\n                type=\"checkbox\"\n                id={ item.ingredient }\n                key={ item.ingredient }\n                name={ item.ingredient }\n                value={ item.ingredient }\n                checked={ JSON.parse(localStorage.getItem(item.ingredient)) }\n                onChange={ (e) => handleProgress(e) }\n              />\n              <label htmlFor={ item.ingredient }>\n                {\n                  `${index + 1} - ${item.ingredient}: ${item.measure}`\n                }\n              </label>\n            </div>\n          ))}\n      </div>\n\n      <p data-testid=\"instructions\">\n        {foodDetails.strInstructions}\n      </p>\n\n      <video data-testid=\"video\" width=\"750\" height=\"500\" controls>\n        <source\n          src={ foodDetails.strYoutube }\n          type=\"video/mp4\"\n        />\n        <track src=\"\" kind=\"captions\" />\n      </video>\n      <Link to=\"/receitas-feitas\">\n        <button\n          type=\"button\"\n          data-testid=\"finish-recipe-btn\"\n          disabled={ stateButton }\n          onClick={ handleClickEnd }\n        >\n          Finalizar receita\n        </button>\n      </Link>\n    </div>\n  );\n}\n\nexport default FoodDetailsProgress;\n"]},"metadata":{},"sourceType":"module"}