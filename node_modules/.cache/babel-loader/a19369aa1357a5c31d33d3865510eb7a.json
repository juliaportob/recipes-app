{"ast":null,"code":"var _jsxFileName = \"/home/julia/Trybe/projects_Trybe/sd-06-project-recipes-app/src/pages/DrinksDetailsProgress.js\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { requestDetailsDrinks } from '../services/requestsAPI';\nimport RecipesContext from '../context/RecipesContext';\nimport shareIcon from \"../images/shareIcon.svg\";\nimport whiteHeartIcon from \"../images/whiteHeartIcon.svg\";\nimport blackHeartIcon from \"../images/blackHeartIcon.svg\";\n\nfunction DrinksDetailsProgress() {\n  const url = document.URL;\n  const actualId = url.split('/')[4];\n  const {\n    drinkDetails,\n    setDrinkDetails\n  } = useContext(RecipesContext);\n  const [ingredients, setIngredients] = useState('');\n  const [spanHidden, setSpanHidden] = useState(true);\n  const [favoriteDrink, setFavoriteDrink] = useState(false);\n  const [checkedIngredients] = useState([]);\n  const [stateButton, setStateButton] = useState(true);\n\n  function verifyLocalStorage() {\n    if (localStorage.getItem('inProgressRecipes') === null) {\n      const recipesInProgress = {\n        cocktails: {},\n        meals: {}\n      };\n      localStorage.setItem('inProgressRecipes', JSON.stringify(recipesInProgress));\n    }\n  }\n\n  function enableButton() {\n    setStateButton(true);\n    const markedCheckboxes = document.querySelectorAll('input:checked');\n    const checkboxes = document.getElementsByClassName('check');\n    console.log('check1', markedCheckboxes.length);\n    console.log('check2', checkboxes.length);\n\n    if (checkboxes.length === markedCheckboxes.length) {\n      setStateButton(false);\n    }\n  }\n\n  function handleProgress(e) {\n    checkedIngredients.push(e.target.value);\n    const localStorageRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    localStorageRecipes.cocktails[drinkDetails.idDrink] = checkedIngredients;\n    localStorage.setItem('inProgressRecipes', JSON.stringify(localStorageRecipes));\n    localStorage.setItem(e.target.value, e.target.checked);\n    enableButton();\n  }\n\n  useEffect(() => {\n    verifyLocalStorage();\n  }, []);\n  useEffect(() => {\n    async function fetchData() {\n      const resultsDetails = await requestDetailsDrinks(actualId);\n      const drink = resultsDetails.drinks[0];\n      setDrinkDetails(drink);\n      const keysDrink = Object.keys(drink);\n      const filterDrink = keysDrink.filter(key => key.toLowerCase().includes('ingredient'));\n      const filterMeasure = keysDrink.filter(key => key.toLowerCase().includes('measure'));\n      const allIngredients = filterDrink.map((item, index) => ({\n        ingredient: drink[item],\n        measure: drink[filterMeasure[index]]\n      })).filter(item => item.ingredient !== '' && item.ingredient !== null);\n      console.log(allIngredients);\n      setIngredients(allIngredients);\n    }\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    const meuLocal = localStorage.getItem('favoriteRecipes');\n    console.log('local2', meuLocal);\n\n    if (meuLocal !== null) {\n      const meuLocalArray = JSON.parse(meuLocal);\n      console.log(meuLocalArray); // const idAtual = actualId[4];\n\n      const findId = meuLocalArray.find(element => element.id === actualId);\n      console.log(findId);\n\n      if (findId !== undefined) {\n        setFavoriteDrink(true);\n      }\n    }\n  }, []);\n\n  function copyToClipBoard(text) {\n    const textSplice = text.split('/in-progress');\n    const finalText = textSplice.join('');\n    navigator.clipboard.writeText(finalText);\n    setSpanHidden(false);\n  }\n\n  function handleFavoriteDrink() {\n    setFavoriteDrink(!favoriteDrink);\n\n    if (favoriteDrink === false) {\n      const favoriteObj = [{\n        id: drinkDetails.idDrink,\n        type: 'bebida',\n        area: '',\n        category: drinkDetails.strCategory,\n        alcoholicOrNot: drinkDetails.strAlcoholic,\n        name: drinkDetails.strDrink,\n        image: drinkDetails.strDrinkThumb\n      }];\n\n      if (localStorage.getItem('favoriteRecipes') === null) {\n        localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteObj));\n      } else {\n        localStorage.setItem('favoriteRecipes', JSON.stringify([...JSON.parse(localStorage.getItem('favoriteRecipes')), favoriteObj]));\n      }\n\n      if (favoriteDrink === true) {\n        setFavoriteDrink(false);\n        const arrayDoStorage = JSON.parse(localStorage.getItem('favoriteRecipes'));\n        console.log(arrayDoStorage);\n        const novoArray = arrayDoStorage.filter(element => element.id !== actualId);\n        console.log(novoArray);\n        localStorage.setItem('favoriteRecipes', JSON.stringify(novoArray));\n      }\n    }\n  }\n\n  function handleClickEnd() {\n    const time = new Date();\n    const object = [{\n      id: drinkDetails.idDrink,\n      type: 'bebida',\n      area: '',\n      category: drinkDetails.strCategory,\n      alcoholicOrNot: drinkDetails.strAlcoholic,\n      name: drinkDetails.strDrink,\n      image: drinkDetails.strDrinkThumb,\n      doneDate: time,\n      tags: drinkDetails.strTags\n    }];\n\n    if (localStorage.getItem('doneRecipes') === null) {\n      localStorage.setItem('doneRecipes', JSON.stringify(object));\n    } else {\n      localStorage.setItem('doneRecipes', JSON.stringify([...JSON.parse(localStorage.getItem('doneRecipes')), ...object]));\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    \"data-testid\": \"recipe-photo\",\n    width: \"100px\",\n    src: drinkDetails.strDrinkThumb,\n    alt: \"Drink\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    \"data-testid\": \"recipe-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }\n  }, drinkDetails.strDrink), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"share-btn\",\n    onClick: () => copyToClipBoard(document.URL),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: shareIcon,\n    alt: \"Share\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    hidden: spanHidden,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }\n  }, \"Link copiado!\"), /*#__PURE__*/React.createElement(\"button\", {\n    \"aria-label\": \"favorite-button\",\n    type: \"button\",\n    \"data-testid\": \"favorite-btn\",\n    className: whiteHeartIcon,\n    onClick: handleFavoriteDrink,\n    src: favoriteDrink ? blackHeartIcon : whiteHeartIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"bla\",\n    src: favoriteDrink ? blackHeartIcon : whiteHeartIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"h4\", {\n    \"data-testid\": \"recipe-category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }, drinkDetails.strCategory), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }\n  }, drinkDetails.strAlcoholic), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"ingredients-div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }\n  }, ingredients && ingredients.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    \"data-testid\": `${index}-ingredient-step`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: item.ingredient,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    className: \"check\",\n    id: item.ingredient,\n    key: item.ingredient,\n    name: item.ingredient,\n    value: item.ingredient,\n    checked: JSON.parse(localStorage.getItem(item.ingredient)),\n    onChange: e => handleProgress(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }), `${index + 1} - ${item.ingredient}: ${item.measure}`)))), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }\n  }, drinkDetails.strInstructions), /*#__PURE__*/React.createElement(\"span\", {\n    hidden: spanHidden,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }\n  }, \"Link copiado!\"), /*#__PURE__*/React.createElement(Link, {\n    to: {\n      pathname: '/receitas-feitas',\n      state: {\n        drinkDoneCard: drinkDetails\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"finish-recipe-btn\",\n    disabled: stateButton,\n    onClick: handleClickEnd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 9\n    }\n  }, \"Finalizar receita\")));\n}\n\nexport default DrinksDetailsProgress;","map":{"version":3,"sources":["/home/julia/Trybe/projects_Trybe/sd-06-project-recipes-app/src/pages/DrinksDetailsProgress.js"],"names":["React","useContext","useEffect","useState","Link","requestDetailsDrinks","RecipesContext","DrinksDetailsProgress","url","document","URL","actualId","split","drinkDetails","setDrinkDetails","ingredients","setIngredients","spanHidden","setSpanHidden","favoriteDrink","setFavoriteDrink","checkedIngredients","stateButton","setStateButton","verifyLocalStorage","localStorage","getItem","recipesInProgress","cocktails","meals","setItem","JSON","stringify","enableButton","markedCheckboxes","querySelectorAll","checkboxes","getElementsByClassName","console","log","length","handleProgress","e","push","target","value","localStorageRecipes","parse","idDrink","checked","fetchData","resultsDetails","drink","drinks","keysDrink","Object","keys","filterDrink","filter","key","toLowerCase","includes","filterMeasure","allIngredients","map","item","index","ingredient","measure","meuLocal","meuLocalArray","findId","find","element","id","undefined","copyToClipBoard","text","textSplice","finalText","join","navigator","clipboard","writeText","handleFavoriteDrink","favoriteObj","type","area","category","strCategory","alcoholicOrNot","strAlcoholic","name","strDrink","image","strDrinkThumb","arrayDoStorage","novoArray","handleClickEnd","time","Date","object","doneDate","tags","strTags","shareIcon","whiteHeartIcon","blackHeartIcon","strInstructions","pathname","state","drinkDoneCard"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { requestDetailsDrinks } from '../services/requestsAPI';\nimport RecipesContext from '../context/RecipesContext';\nimport shareIcon from '../images/shareIcon.svg';\nimport whiteHeartIcon from '../images/whiteHeartIcon.svg';\nimport blackHeartIcon from '../images/blackHeartIcon.svg';\n\nfunction DrinksDetailsProgress() {\n  const url = document.URL;\n  const actualId = url.split('/')[4];\n  const { drinkDetails, setDrinkDetails } = useContext(RecipesContext);\n  const [ingredients, setIngredients] = useState('');\n  const [spanHidden, setSpanHidden] = useState(true);\n  const [favoriteDrink, setFavoriteDrink] = useState(false);\n  const [checkedIngredients] = useState([]);\n  const [stateButton, setStateButton] = useState(true);\n\n  function verifyLocalStorage() {\n    if (localStorage.getItem('inProgressRecipes') === null) {\n      const recipesInProgress = {\n        cocktails: {},\n        meals: {},\n      };\n      localStorage.setItem('inProgressRecipes', JSON.stringify(recipesInProgress));\n    }\n  }\n\n  function enableButton() {\n    setStateButton(true);\n    const markedCheckboxes = document.querySelectorAll('input:checked');\n    const checkboxes = document.getElementsByClassName('check');\n    console.log('check1', markedCheckboxes.length);\n    console.log('check2', checkboxes.length);\n    if (checkboxes.length === markedCheckboxes.length) {\n      setStateButton(false);\n    }\n  }\n\n  function handleProgress(e) {\n    checkedIngredients.push((e.target.value));\n    const localStorageRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    localStorageRecipes.cocktails[drinkDetails.idDrink] = checkedIngredients;\n    localStorage.setItem('inProgressRecipes', JSON.stringify(localStorageRecipes));\n    localStorage.setItem(e.target.value, e.target.checked);\n    enableButton();\n  }\n\n  useEffect(() => {\n    verifyLocalStorage();\n  }, []);\n\n  useEffect(() => {\n    async function fetchData() {\n      const resultsDetails = await requestDetailsDrinks(actualId);\n      const drink = resultsDetails.drinks[0];\n      setDrinkDetails(drink);\n      const keysDrink = Object.keys(drink);\n      const filterDrink = keysDrink\n        .filter((key) => key.toLowerCase().includes('ingredient'));\n      const filterMeasure = keysDrink.filter((key) => key\n        .toLowerCase().includes('measure'));\n      const allIngredients = filterDrink\n        .map((item, index) => ({\n          ingredient: drink[item], measure: drink[filterMeasure[index]],\n        })).filter((item) => item.ingredient !== '' && item.ingredient !== null);\n      console.log(allIngredients);\n      setIngredients(allIngredients);\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    const meuLocal = localStorage.getItem('favoriteRecipes');\n    console.log('local2', meuLocal);\n    if (meuLocal !== null) {\n      const meuLocalArray = JSON.parse(meuLocal);\n      console.log(meuLocalArray);\n      // const idAtual = actualId[4];\n      const findId = meuLocalArray.find((element) => element.id === actualId);\n      console.log(findId);\n      if (findId !== undefined) {\n        setFavoriteDrink(true);\n      }\n    }\n  }, []);\n\n  function copyToClipBoard(text) {\n    const textSplice = text.split('/in-progress');\n    const finalText = textSplice.join('');\n    navigator.clipboard.writeText(finalText);\n    setSpanHidden(false);\n  }\n\n  function handleFavoriteDrink() {\n    setFavoriteDrink(!favoriteDrink);\n    if (favoriteDrink === false) {\n      const favoriteObj = [\n        {\n          id: drinkDetails.idDrink,\n          type: 'bebida',\n          area: '',\n          category: drinkDetails.strCategory,\n          alcoholicOrNot: drinkDetails.strAlcoholic,\n          name: drinkDetails.strDrink,\n          image: drinkDetails.strDrinkThumb,\n        },\n      ];\n      if (localStorage.getItem('favoriteRecipes') === null) {\n        localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteObj));\n      } else {\n        localStorage.setItem(\n          'favoriteRecipes',\n          JSON.stringify([\n            ...JSON.parse(localStorage.getItem('favoriteRecipes')),\n            favoriteObj,\n          ]),\n        );\n      }\n      if (favoriteDrink === true) {\n        setFavoriteDrink(false);\n        const arrayDoStorage = JSON.parse(localStorage.getItem('favoriteRecipes'));\n        console.log(arrayDoStorage);\n        const novoArray = arrayDoStorage.filter((element) => element.id !== actualId);\n        console.log(novoArray);\n        localStorage.setItem('favoriteRecipes', JSON.stringify(novoArray));\n      }\n    }\n  }\n\n  function handleClickEnd() {\n    const time = new Date();\n    const object = [\n      {\n        id: drinkDetails.idDrink,\n        type: 'bebida',\n        area: '',\n        category: drinkDetails.strCategory,\n        alcoholicOrNot: drinkDetails.strAlcoholic,\n        name: drinkDetails.strDrink,\n        image: drinkDetails.strDrinkThumb,\n        doneDate: time,\n        tags: drinkDetails.strTags,\n      },\n    ];\n\n    if (localStorage.getItem('doneRecipes') === null) {\n      localStorage.setItem('doneRecipes', JSON.stringify(object));\n    } else {\n      localStorage.setItem(\n        'doneRecipes',\n        JSON.stringify([\n          ...JSON.parse(localStorage.getItem('doneRecipes')),\n          ...object,\n        ]),\n      );\n    }\n  }\n\n  return (\n    <div>\n\n      <img\n        data-testid=\"recipe-photo\"\n        width=\"100px\"\n        src={ drinkDetails.strDrinkThumb }\n        alt=\"Drink\"\n      />\n\n      <h3 data-testid=\"recipe-title\">\n        {\n          drinkDetails.strDrink\n        }\n      </h3>\n\n      <button\n        type=\"button\"\n        data-testid=\"share-btn\"\n        onClick={ () => copyToClipBoard(document.URL) }\n      >\n        <img src={ shareIcon } alt=\"Share\" />\n      </button>\n\n      <span hidden={ spanHidden }>Link copiado!</span>\n\n      <button\n        aria-label=\"favorite-button\"\n        type=\"button\"\n        data-testid=\"favorite-btn\"\n        className={ whiteHeartIcon }\n        onClick={ handleFavoriteDrink }\n        src={ favoriteDrink ? blackHeartIcon : whiteHeartIcon }\n      >\n        <img alt=\"bla\" src={ favoriteDrink ? blackHeartIcon : whiteHeartIcon } />\n      </button>\n      <h4 data-testid=\"recipe-category\">\n        {\n          drinkDetails.strCategory\n        }\n      </h4>\n\n      <h4>\n        {\n          drinkDetails.strAlcoholic\n        }\n      </h4>\n\n      <div id=\"ingredients-div\">\n        {ingredients && ingredients\n          .map((item, index) => (\n            <div key={ index } data-testid={ `${index}-ingredient-step` }>\n              <label htmlFor={ item.ingredient }>\n                <input\n                  type=\"checkbox\"\n                  className=\"check\"\n                  id={ item.ingredient }\n                  key={ item.ingredient }\n                  name={ item.ingredient }\n                  value={ item.ingredient }\n                  checked={ JSON.parse(localStorage.getItem(item.ingredient)) }\n                  onChange={ (e) => handleProgress(e) }\n                />\n                {\n                  `${index + 1} - ${item.ingredient}: ${item.measure}`\n                }\n              </label>\n            </div>\n          ))}\n      </div>\n\n      <p\n        data-testid=\"instructions\"\n      >\n        {drinkDetails.strInstructions}\n      </p>\n\n      <span hidden={ spanHidden }>Link copiado!</span>\n      <Link\n        to={\n          { pathname: '/receitas-feitas', state: { drinkDoneCard: drinkDetails } }\n        }\n      >\n        <button\n          type=\"button\"\n          data-testid=\"finish-recipe-btn\"\n          disabled={ stateButton }\n          onClick={ handleClickEnd }\n        >\n          Finalizar receita\n        </button>\n      </Link>\n    </div>\n  );\n}\n\nexport default DrinksDetailsProgress;\n"]},"metadata":{},"sourceType":"module"}